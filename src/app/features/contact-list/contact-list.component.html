<div class="container mx-auto">
  <div class="p-6">

    <!-- Search -->
    <div class="mb-4 flex items-center gap-3">
      <div class="relative w-full max-w-md">
        <input type="text" [(ngModel)]="searchTerm" placeholder="Search name, phone, or email"
          class="w-full rounded-xl border border-gray-300 px-4 py-2 pr-10 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
        <span class="pointer-events-none absolute inset-y-0 right-3 flex items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 opacity-60" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd"
              d="M12.9 14.32a8 8 0 111.414-1.414l3.387 3.387a1 1 0 01-1.414 1.414l-3.387-3.387zM14 8a6 6 0 11-12 0 6 6 0 0112 0z"
              clip-rule="evenodd" />
          </svg>
        </span>
      </div>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto rounded-xl border border-gray-200">
      <table class="min-w-[75rem] w-full text-left">
        <thead class="bg-gray-50">
          <tr class="text-gray-700">
            <th class="px-4 py-3 w-[22%]">Name</th>
            <th class="px-4 py-3 w-[22%]">Phone number</th>
            <th class="px-4 py-3 w-[22%]">Email Address</th>
            <th class="px-4 py-3 w-[22%]">Date added</th>
            <th class="px-4 py-3 w-[12%]">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let contact of contactsList | search: searchTerm; trackBy: trackById"
            class="border-t hover:bg-gray-50">
            <!-- Switch to edit inputs if this row is in edit mode -->
            <ng-container *ngIf="editingId === contact.id; else viewRow">
              <td class="px-4 py-3">
                <input type="text" [(ngModel)]="editModel.name"
                  class="w-full rounded-lg border border-gray-300 px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
              </td>
              <td class="px-4 py-3">
                <input type="text" [(ngModel)]="editModel.phone"
                  class="w-full rounded-lg border border-gray-300 px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
              </td>
              <td class="px-4 py-3">
                <input type="email" [(ngModel)]="editModel.email"
                  class="w-full rounded-lg border border-gray-300 px-3 py-1.5 focus:outline-none focus:ring-2 focus:ring-indigo-500" />
              </td>
              <td class="px-4 py-3">
                {{ contact.dateAdded | date:'mediumDate' }}
              </td>
              <td class="px-4 py-3 space-x-2">
                <button (click)="saveEdit(contact)"
                  class="rounded-lg bg-green-600 px-3 py-1.5 text-white hover:bg-green-700">
                  Save
                </button>
                <button (click)="cancelEdit()"
                  class="rounded-lg bg-gray-200 px-3 py-1.5 text-gray-800 hover:bg-gray-300">
                  Cancel
                </button>
              </td>
            </ng-container>

            <ng-template #viewRow>
              <td class="px-4 py-3 font-medium text-gray-900">
                {{ contact.name }}
              </td>
              <td class="px-4 py-3">
                {{ contact.phone | phone }}
              </td>
              <td class="px-4 py-3">
                {{ contact.email }}
              </td>
              <td class="px-4 py-3">
                {{ contact.dateAdded | date:'mediumDate' }}
              </td>
              <td class="px-4 py-3 space-x-2">
                <button (click)="startEdit(contact)"
                  class="rounded-lg bg-indigo-600 px-3 py-1.5 text-white hover:bg-indigo-700">
                  Edit
                </button>
                <button (click)="deleteContact(contact.id)"
                  class="rounded-lg bg-rose-600 px-3 py-1.5 text-white hover:bg-rose-700">
                  Delete
                </button>
              </td>
            </ng-template>
          </tr>

          <!-- Empty state -->
          <tr *ngIf="(contactsList | search: searchTerm).length === 0">
            <td colspan="5" class="px-4 py-6 text-center text-gray-500">
              No contacts found.
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>